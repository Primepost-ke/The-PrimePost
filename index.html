<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Prime Post — Card Creator</title>
<style>
  :root{
    --green:#006b3c;
    --green-2:#00994d;
    --gold:#ffd700;
    --white:#ffffff;
    --light-green:#c9f7df;
  }
  body{
    font-family: Arial, Helvetica, sans-serif;
    margin:16px;
    background:#f4f4f9;
    color:#222;
  }
  .container{
    max-width:900px;
    margin:0 auto;
    display:grid;
    grid-template-columns:1fr 420px;
    gap:18px;
    align-items:start;
  }
  h1{ margin:0 0 12px 0; color:var(--green); font-size:20px; }
  p.small{ margin:6px 0 14px 0; color:#444; font-size:13px; }
  .panel{
    background:#fff;
    padding:14px;
    border-radius:8px;
    box-shadow:0 6px 18px rgba(0,0,0,0.06);
  }
  .form-row{ margin-bottom:10px; }
  label{ display:block; font-weight:bold; color:var(--green); margin-bottom:6px; font-size:13px; }
  input[type="text"], textarea, input[type="url"]{
    width:100%;
    padding:8px 10px;
    border:1px solid #ddd;
    border-radius:6px;
    font-size:14px;
    box-sizing:border-box;
  }
  textarea{ min-height:90px; resize:vertical; }
  input[type="file"]{ font-size:13px; }

  .btn{
    display:inline-block;
    background:var(--green);
    color:var(--white);
    padding:10px 14px;
    border-radius:8px;
    text-decoration:none;
    cursor:pointer;
    border:none;
    font-weight:bold;
  }
  .btn.secondary{
    background:#eee;
    color:#222;
    border:1px solid #ddd;
    margin-left:8px;
  }

  .preview-wrap{
    display:flex;
    gap:12px;
    align-items:flex-start;
    flex-direction:column;
  }
  .card-preview{
    width:320px;
    height:280px;
    border-radius:10px;
    overflow:hidden;
    position:relative;
    box-shadow:0 6px 18px rgba(0,0,0,0.12);
    background:linear-gradient(180deg,var(--green) 0%, var(--green-2) 100%);
    color:var(--white);
    padding:14px;
    box-sizing:border-box;
    display:flex;
    flex-direction:column;
    justify-content:flex-end; /* moved text to bottom */
  }

  /* Added logo section */
  .card-top{
    position:absolute;
    top:10px;
    left:12px;
    display:flex;
    align-items:center;
    gap:8px;
  }
  .pp-logo{
    width:42px;
    height:42px;
    border-radius:50%;
    background:var(--light-green);
    border:2px solid var(--gold);
    display:flex;
    align-items:center;
    justify-content:center;
    font-weight:bold;
    font-size:18px;
    color:black;
    text-shadow:0 0 2px rgba(0,0,0,0.3);
  }
  .pp-text{
    font-weight:bold;
    color:var(--gold);
    font-size:15px;
  }

  .card-title{ font-size:16px; font-weight:bold; margin:8px 0 0 0; color:#fff; line-height:1.1; }
  .card-desc{ font-size:15px; font-weight:bold; opacity:0.98; margin-top:6px; color:#fff; }
  .card-link{ font-size:12px; margin-top:8px; color:var(--gold); font-weight:bold; text-decoration:underline; }

  .watermark{
    position:absolute;
    left:-30px;
    top:50%;
    transform:rotate(-30deg) translateY(-50%);
    font-size:34px;
    color:rgba(255,255,255,0.06);
    font-weight:bold;
    pointer-events:none;
    user-select:none;
    white-space:nowrap;
  }

  .note{ font-size:12px; color:#666; margin-top:8px; }
  .actions{ margin-top:10px; display:flex; gap:8px; align-items:center; }

  @media (max-width:980px){
    .container{ grid-template-columns:1fr; }
    .card-preview{ width:100%; max-width:360px; height:300px; margin:auto; }
  }
</style>
</head>
<body>

<div class="container">
  <div class="panel">
    <h1>Prime Post Card Creator</h1>
    <p class="small">Upload an image, enter title, short text and link. Click "Render" then "Download PNG".</p>

    <div class="form-row">
      <label for="image">Image (feature image)</label>
      <input id="image" type="file" accept="image/*">
    </div>

    <div class="form-row">
      <label for="title">Title</label>
      <input id="title" type="text" placeholder="Enter headline (example: Caretaker or Commander? ... )">
    </div>

    <div class="form-row">
      <label for="desc">Short text (preview)</label>
      <textarea id="desc" placeholder="Short summary for the card (max ~30-40 words)"></textarea>
    </div>

    <div class="form-row">
      <label for="link">Article link (optional)</label>
      <input id="link" type="url" placeholder="https://...">
    </div>

    <div class="actions">
      <button class="btn" id="renderBtn">Render</button>
      <button class="btn secondary" id="downloadBtn" disabled>Download PNG</button>
      <button class="btn secondary" id="resetBtn">Reset</button>
    </div>

    <p class="note">Tip: keep title short so it fits well on the card.</p>
  </div>

  <div class="preview-wrap">
    <div class="panel">
      <div class="card-preview" id="cardPreview">
        <div class="card-top">
          <div class="pp-logo">PP</div>
          <div class="pp-text">The PrimePost</div>
        </div>
        <div class="watermark">PRIME POST</div>
        <div>
          <div class="card-title" id="cardTitle">Card title will appear here</div>
          <div class="card-desc" id="cardDesc">Short description will appear here — keep it short for best results.</div>
        </div>
        <div>
          <div class="card-link" id="cardLink">primepost.co.ke</div>
        </div>
      </div>
    </div>

    <canvas id="cardCanvas" width="1200" height="630" style="display:none;"></canvas>
  </div>
</div>

<script>
const imageInput = document.getElementById('image');
const titleInput = document.getElementById('title');
const descInput = document.getElementById('desc');
const linkInput = document.getElementById('link');
const renderBtn = document.getElementById('renderBtn');
const downloadBtn = document.getElementById('downloadBtn');
const resetBtn = document.getElementById('resetBtn');
const cardTitle = document.getElementById('cardTitle');
const cardDesc = document.getElementById('cardDesc');
const cardLink = document.getElementById('cardLink');
const cardPreview = document.getElementById('cardPreview');
const canvas = document.getElementById('cardCanvas');
const ctx = canvas.getContext('2d');
let uploadedImage = null;

function updatePreview(){
  cardTitle.textContent = titleInput.value.trim() || 'Card title will appear here';
  cardDesc.textContent = descInput.value.trim() || 'Short description will appear here — keep it short for best results.';
  cardLink.textContent = linkInput.value.trim() || 'primepost.co.ke';
  if(uploadedImage){
    cardPreview.style.backgroundImage = `url(${uploadedImage.src})`;
    cardPreview.style.backgroundSize = 'cover';
    cardPreview.style.backgroundPosition = 'center';
  } else {
    cardPreview.style.backgroundImage = '';
    cardPreview.style.background = 'linear-gradient(180deg, var(--green) 0%, var(--green-2) 100%)';
  }
}

imageInput.addEventListener('change', e=>{
  const f = e.target.files && e.target.files[0];
  if(!f) return;
  const reader = new FileReader();
  reader.onload = ev=>{
    const img = new Image();
    img.onload = ()=>{ uploadedImage = img; updatePreview(); };
    img.src = ev.target.result;
  };
  reader.readAsDataURL(f);
});

resetBtn.addEventListener('click', ()=>{
  titleInput.value=''; descInput.value=''; linkInput.value=''; imageInput.value='';
  uploadedImage=null; cardPreview.style.backgroundImage='';
  updatePreview(); downloadBtn.disabled=true;
});

function wrapText(ctx, text, x, y, maxWidth, lineHeight){
  const words=text.split(' '); let line='';
  for(let n=0;n<words.length;n++){
    const testLine=line+words[n]+' ';
    if(ctx.measureText(testLine).width>maxWidth && n>0){
      ctx.fillText(line,x,y); line=words[n]+' '; y+=lineHeight;
    } else line=testLine;
  }
  ctx.fillText(line,x,y); return y;
}

renderBtn.addEventListener('click', ()=>{
  updatePreview();
  const W=1200,H=800;
  canvas.width=W; canvas.height=H;

  if(uploadedImage){
    const img=uploadedImage;
    const imgRatio=img.width/img.height,canvasRatio=W/H;
    let sx,sy,sWidth,sHeight;
    if(imgRatio>canvasRatio){sHeight=img.height;sWidth=img.height*canvasRatio;sx=(img.width-sWidth)/2;sy=0;}
    else{sWidth=img.width;sHeight=img.width/canvasRatio;sx=0;sy=(img.height-sHeight)/2;}
    ctx.drawImage(img,sx,sy,sWidth,sHeight,0,0,W,H);
    const g=ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0,'rgba(0,0,0,0.18)'); g.addColorStop(1,'rgba(0,0,0,0.28)');
    ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
  } else {
    const g=ctx.createLinearGradient(0,0,0,H);
    g.addColorStop(0,'#006b3c'); g.addColorStop(1,'#00994d');
    ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
  }

  ctx.fillStyle='#c9f7df';
  ctx.beginPath();
  ctx.arc(60,60,26,0,Math.PI*2);
  ctx.fill();
  ctx.lineWidth=4;
  ctx.strokeStyle='#ffd700';
  ctx.stroke();
  ctx.font='bold 28px Arial';
  ctx.fillStyle='black';
  ctx.fillText('PP',45,70);
  ctx.font='bold 22px Arial';
  ctx.fillStyle='#ffd700';
  ctx.fillText('The PrimePost',100,70);

  ctx.save();
  ctx.translate(W*0.06,H*0.5);
  ctx.rotate(-0.5);
  ctx.font='bold 80px Arial';
  ctx.fillStyle='rgba(255,255,255,0.06)';
  ctx.fillText('PRIME POST',0,0);
  ctx.restore();

  ctx.fillStyle='#ffffff';
  ctx.font='bold 46px Arial';
  wrapText(ctx,titleInput.value.trim()||'Card title will appear here',40,520,W-80,52); /* shifted down */

  ctx.font='bold 26px Arial';
  ctx.fillStyle='rgba(255,255,255,0.95)';
  wrapText(ctx,descInput.value.trim()||'Short description will appear here — keep it short for best results.',40,620,W-80,36); /* shifted down */

  ctx.font='bold 18px Arial';
  ctx.fillStyle='#ffd700';
  ctx.fillText(linkInput.value.trim()||'primepost.co.ke',40,H-36);

  downloadBtn.disabled=false;
});

downloadBtn.addEventListener('click', ()=>{
  const dataUrl=canvas.toDataURL('image/png');
  const a=document.createElement('a');
  a.href=dataUrl; a.download=(titleInput.value.trim().slice(0,30)||'primepost-card')+'.png';
  document.body.appendChild(a); a.click(); a.remove();
});

[titleInput,descInput,linkInput].forEach(inp=>inp.addEventListener('input',updatePreview));
updatePreview();
</script>
</body>
</html>
